<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Group features based on approximate retention times — groupFeatures-similar-rtime • MsFeatures</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Group features based on approximate retention times — groupFeatures-similar-rtime" />
<meta property="og:description" content="Group features based on similar retention time. This method is supposed to be
used as an initial crude grouping of LC-MS features based on the median
retention time of all their chromatographic peaks. All features with a
difference in their retention time which is &amp;lt;= parameter diffRt of the
parameter object are grouped together. If a column &quot;feature_group&quot; is
found in
SummarizedExperiment::colData() this is further sub-grouped by this method.
For object being a SummarizedExperiment it might be required to specify
the column in the object's rowData containing the retention times with the
rtime parameter (which defaults to rtime = &quot;rtime&quot;.
Parameter groupFun allows to specify the function that should be used for
the actual grouping. Two possible choices are:
groupFun = groupClosest (the default): this method creates groups
of features with smallest differences in retention times between the
individual group members. All differences between group members are
&amp;lt; diffRt (in contrast to the other grouping functions listed below).
See groupSimilarityMatrix() (which is used for the actual grouping on
pairwise retention time differences) for more details.
groupFun = groupConsecutive: the groupConsecutive() function
groups values together if their difference is smaller than diffRt. This
function iterates over the sorted retention times starting the grouping
from the lowest value.
If the difference of a feature to more than one group is smaller diffRt
it is assigned to the group to which its retention time is closest (most
similar) to the mean retention time of that group. This leads to smaller
group sizes. Be aware that with this grouping differences in retention
times between individual features within a group could still be larger
diffRt. See groupConsecutive() for details and examples.
groupFun = MsCoreUtils::group: this function consecutively groups
elements together if their difference in retention time is smaller than
diffRt. If two features are grouped into one group, also all other
features with a retention time within the defined window to any of the two
features are also included into the feature group. This grouping is
recursively expanded which can lead, depending on diffRt, to very large
feature groups spanning a large retention time window. See
MsCoreUtils::group() for details.


Other grouping functions might be added in future. Alternatively it is also
possible to provide a custom function for the grouping operation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MsFeatures</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RforMassSpectrometry/MsFeatures/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Group features based on approximate retention times</h1>
    <small class="dont-index">Source: <a href='https://github.com/RforMassSpectrometry/MsFeatures/blob/master/R/SimilarRtimeParam.R'><code>R/SimilarRtimeParam.R</code></a></small>
    <div class="hidden name"><code>groupFeatures-similar-rtime.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Group features based on similar retention time. This method is supposed to be
used as an initial <em>crude</em> grouping of LC-MS features based on the median
retention time of all their chromatographic peaks. All features with a
difference in their retention time which is <code>&lt;=</code> parameter <code>diffRt</code> of the
parameter object are grouped together. If a column <code>"feature_group"</code> is
found in
<code><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>SummarizedExperiment::colData()</a></code> this is further sub-grouped by this method.
For <code>object</code> being a <code>SummarizedExperiment</code> it might be required to specify
the column in the object's <code>rowData</code> containing the retention times with the
<code>rtime</code> parameter (which defaults to <code>rtime = "rtime"</code>.</p>
<p>Parameter <code>groupFun</code> allows to specify the function that should be used for
the actual grouping. Two possible choices are:</p><ul>
<li><p><code>groupFun = groupClosest</code> (the default): this method creates groups
of features with smallest differences in retention times between the
individual group members. All differences between group members are
<code>&lt; diffRt</code> (in contrast to the other grouping functions listed below).
See <code><a href='groupSimilarityMatrix.html'>groupSimilarityMatrix()</a></code> (which is used for the actual grouping on
pairwise retention time differences) for more details.</p></li>
<li><p><code>groupFun = groupConsecutive</code>: the <code><a href='groupConsecutive.html'>groupConsecutive()</a></code> function
groups values together if their difference is smaller than <code>diffRt</code>. This
function iterates over the sorted retention times starting the grouping
from the lowest value.
If the difference of a feature to more than one group is smaller <code>diffRt</code>
it is assigned to the group to which its retention time is closest (most
similar) to the mean retention time of that group. This leads to smaller
group sizes. Be aware that with this grouping differences in retention
times between individual features within a group could still be larger
<code>diffRt</code>. See <code><a href='groupConsecutive.html'>groupConsecutive()</a></code> for details and examples.</p></li>
<li><p><code>groupFun = MsCoreUtils::group</code>: this function consecutively groups
elements together if their difference in retention time is smaller than
<code>diffRt</code>. If two features are grouped into one group, also all other
features with a retention time within the defined window to any of the two
features are also included into the feature group. This grouping is
recursively expanded which can lead, depending on <code>diffRt</code>, to very large
feature groups spanning a large retention time window. See
<code><a href='https://rdrr.io/pkg/MsCoreUtils/man/group.html'>MsCoreUtils::group()</a></code> for details.</p></li>
</ul>

<p>Other grouping functions might be added in future. Alternatively it is also
possible to provide a custom function for the grouping operation.</p>
    </div>

    <pre class="usage"><span class='fu'>SimilarRtimeParam</span><span class='op'>(</span>diffRt <span class='op'>=</span> <span class='fl'>1</span>, groupFun <span class='op'>=</span> <span class='va'>groupClosest</span><span class='op'>)</span>

<span class='co'># S4 method for numeric,SimilarRtimeParam</span>
<span class='fu'><a href='groupFeatures.html'>groupFeatures</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>param</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for SummarizedExperiment,SimilarRtimeParam</span>
<span class='fu'><a href='groupFeatures.html'>groupFeatures</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>param</span>, rtime <span class='op'>=</span> <span class='st'>"rtime"</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>diffRt</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the retention time window within which
features should be grouped. All features with a rtime difference
smaller or equal than <code>diffRt</code> are grouped.</p></td>
    </tr>
    <tr>
      <th>groupFun</th>
      <td><p><code>function</code> that can be used to group values. Defaults to
<code>groupFun = groupClosest</code>. See description for details and
alternatives.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>input object that provides the retention times that should be
grouped. The <code>MsFeatures</code> package defines a method for <code>object</code> being
either a <code>numeric</code> or a <code>SummarizedExperiment</code>.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p><code>SimilarRtimeParam</code> object with the settings for the method.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional parameters passed to the <code>groupFun</code> function.</p></td>
    </tr>
    <tr>
      <th>rtime</th>
      <td><p>for <code>object</code> being a <code><a href='https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html'>SummarizedExperiment()</a></code>: <code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>
specifying the column in <code><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>rowData(object)</a></code> that contains the retention
time values.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Depending on parameter <code>object</code>:</p><ul>
<li><p>for <code>object</code> being a <code>numeric</code>: returns a <code>factor</code> defining the feature
groups.</p></li>
<li><p>for <code>object</code> being <code>SummarizedExperiment</code>: returns the input object with
the feature group definition added to a column <code>"feature_group"</code> in the
result object's <code>rowData</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='groupFeatures.html'>groupFeatures()</a></code> for the general concept of feature grouping.</p>
<p><code><a href='featureGroups.html'>featureGroups()</a></code> for the function to extract defined feature
groups from a <code>SummarizedExperiment</code>.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Simple grouping of a numeric vector.</span>
<span class='co'>##</span>
<span class='co'>## Define a numeric vector that could represent retention times of features</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>11</span>, <span class='fl'>12</span>, <span class='fl'>14</span>, <span class='fl'>15</span><span class='op'>)</span>

<span class='co'>## Group the values using a `group` function. This will create larger</span>
<span class='co'>## groups.</span>
<span class='fu'><a href='groupFeatures.html'>groupFeatures</a></span><span class='op'>(</span><span class='va'>x</span>, param <span class='op'>=</span> <span class='fu'>SimilarRtimeParam</span><span class='op'>(</span><span class='fl'>2</span>, <span class='fu'>MsCoreUtils</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/MsCoreUtils/man/group.html'>group</a></span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1 1 1 1 2 2 2 2 2
#&gt; Levels: 1 2</div><div class='input'>
<span class='co'>## Group values using the default `groupClosest` function. This creates</span>
<span class='co'>## smaller groups in which all elements have a difference smaller than the</span>
<span class='co'>## defined `diffRt` with each other.</span>
<span class='fu'><a href='groupFeatures.html'>groupFeatures</a></span><span class='op'>(</span><span class='va'>x</span>, param <span class='op'>=</span> <span class='fu'>SimilarRtimeParam</span><span class='op'>(</span><span class='fl'>2</span>, <span class='va'>groupClosest</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1 1 1 4 2 2 2 3 3
#&gt; Levels: 1 2 3 4</div><div class='input'>
<span class='co'>## Grouping on a SummarizedExperiment</span>
<span class='co'>##</span>
<span class='co'>## load the test SummarizedExperiment object</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://bioconductor.org/packages/SummarizedExperiment'>SummarizedExperiment</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>se</span><span class='op'>)</span>

<span class='co'>## No feature groups defined yet</span>
<span class='fu'><a href='featureGroups.html'>featureGroups</a></span><span class='op'>(</span><span class='va'>se</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
#&gt;  [26] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
#&gt;  [51] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
#&gt;  [76] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
#&gt; [101] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
#&gt; [126] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
#&gt; [151] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
#&gt; [176] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
#&gt; [201] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA</div><div class='input'>
<span class='co'>## Determine the column that contains retention times</span>
<span class='fu'><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>rowData</a></span><span class='op'>(</span><span class='va'>se</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 225 rows and 11 columns
#&gt;           mzmed     mzmin     mzmax     rtmed     rtmin     rtmax    npeaks
#&gt;       &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
#&gt; FT001     200.1     200.1     200.1   2901.63   2880.73   2922.53         2
#&gt; FT002     205.0     205.0     205.0   2789.39   2782.30   2795.36         8
#&gt; FT003     206.0     206.0     206.0   2788.73   2780.73   2792.86         7
#&gt; FT004     207.1     207.1     207.1   2718.12   2713.21   2726.70         7
#&gt; FT005     219.1     219.1     219.1   2518.82   2517.40   2520.81         3
#&gt; ...         ...       ...       ...       ...       ...       ...       ...
#&gt; FT221    591.30     591.3     591.3   3005.03   2992.87   3006.05         5
#&gt; FT222    592.15     592.1     592.3   3022.11   2981.91   3107.59         6
#&gt; FT223    594.20     594.2     594.2   3418.16   3359.10   3427.90         3
#&gt; FT224    595.25     595.2     595.3   3010.15   2992.87   3013.77         6
#&gt; FT225    596.20     596.2     596.2   2997.91   2992.87   3002.95         2
#&gt;              KO        WT            peakidx  ms_level
#&gt;       &lt;numeric&gt; &lt;numeric&gt;             &lt;list&gt; &lt;integer&gt;
#&gt; FT001         2         0  287, 679,1577,...         1
#&gt; FT002         4         4     47,272,542,...         1
#&gt; FT003         3         4     32,259,663,...         1
#&gt; FT004         4         3     19,249,525,...         1
#&gt; FT005         1         2  639, 788,1376,...         1
#&gt; ...         ...       ...                ...       ...
#&gt; FT221         2         3    349,684,880,...         1
#&gt; FT222         1         3     86,861,862,...         1
#&gt; FT223         1         2  604, 985,1543,...         1
#&gt; FT224         2         3     67,353,876,...         1
#&gt; FT225         0         2  866,1447,1643,...         1</div><div class='input'>
<span class='co'>## Column "rtmed" contains the (median) retention time for each feature</span>
<span class='co'>## Group features that are eluting within 10 seconds</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='groupFeatures.html'>groupFeatures</a></span><span class='op'>(</span><span class='va'>se</span>, <span class='fu'>SimilarRtimeParam</span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>, rtime <span class='op'>=</span> <span class='st'>"rtmed"</span><span class='op'>)</span>

<span class='fu'><a href='featureGroups.html'>featureGroups</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   [1] "FG.021" "FG.001" "FG.001" "FG.057" "FG.062" "FG.019" "FG.062" "FG.075"
#&gt;   [9] "FG.044" "FG.066" "FG.023" "FG.048" "FG.003" "FG.057" "FG.016" "FG.014"
#&gt;  [17] "FG.048" "FG.066" "FG.030" "FG.004" "FG.015" "FG.011" "FG.069" "FG.033"
#&gt;  [25] "FG.033" "FG.025" "FG.071" "FG.069" "FG.002" "FG.033" "FG.013" "FG.050"
#&gt;  [33] "FG.023" "FG.038" "FG.003" "FG.043" "FG.012" "FG.012" "FG.013" "FG.004"
#&gt;  [41] "FG.013" "FG.047" "FG.072" "FG.011" "FG.054" "FG.024" "FG.058" "FG.025"
#&gt;  [49] "FG.032" "FG.012" "FG.003" "FG.001" "FG.005" "FG.005" "FG.006" "FG.004"
#&gt;  [57] "FG.028" "FG.044" "FG.028" "FG.007" "FG.074" "FG.007" "FG.022" "FG.074"
#&gt;  [65] "FG.007" "FG.025" "FG.025" "FG.045" "FG.052" "FG.072" "FG.048" "FG.020"
#&gt;  [73] "FG.027" "FG.008" "FG.064" "FG.018" "FG.008" "FG.016" "FG.060" "FG.018"
#&gt;  [81] "FG.076" "FG.047" "FG.018" "FG.011" "FG.053" "FG.037" "FG.013" "FG.002"
#&gt;  [89] "FG.042" "FG.032" "FG.061" "FG.070" "FG.061" "FG.007" "FG.070" "FG.002"
#&gt;  [97] "FG.008" "FG.046" "FG.065" "FG.008" "FG.022" "FG.022" "FG.033" "FG.061"
#&gt; [105] "FG.077" "FG.047" "FG.014" "FG.023" "FG.064" "FG.045" "FG.021" "FG.078"
#&gt; [113] "FG.007" "FG.042" "FG.079" "FG.059" "FG.040" "FG.025" "FG.027" "FG.040"
#&gt; [121] "FG.027" "FG.018" "FG.009" "FG.065" "FG.045" "FG.020" "FG.018" "FG.021"
#&gt; [129] "FG.024" "FG.052" "FG.015" "FG.037" "FG.038" "FG.052" "FG.043" "FG.036"
#&gt; [137] "FG.067" "FG.035" "FG.067" "FG.053" "FG.053" "FG.032" "FG.073" "FG.071"
#&gt; [145] "FG.073" "FG.037" "FG.054" "FG.056" "FG.028" "FG.056" "FG.006" "FG.053"
#&gt; [153] "FG.014" "FG.060" "FG.034" "FG.049" "FG.044" "FG.049" "FG.041" "FG.026"
#&gt; [161] "FG.059" "FG.036" "FG.008" "FG.006" "FG.008" "FG.019" "FG.035" "FG.016"
#&gt; [169] "FG.015" "FG.015" "FG.006" "FG.041" "FG.024" "FG.045" "FG.055" "FG.029"
#&gt; [177] "FG.030" "FG.015" "FG.059" "FG.068" "FG.068" "FG.055" "FG.055" "FG.031"
#&gt; [185] "FG.031" "FG.031" "FG.020" "FG.080" "FG.025" "FG.081" "FG.029" "FG.049"
#&gt; [193] "FG.029" "FG.082" "FG.040" "FG.010" "FG.010" "FG.068" "FG.046" "FG.040"
#&gt; [201] "FG.039" "FG.009" "FG.058" "FG.063" "FG.083" "FG.063" "FG.026" "FG.017"
#&gt; [209] "FG.065" "FG.009" "FG.009" "FG.017" "FG.017" "FG.034" "FG.084" "FG.011"
#&gt; [217] "FG.072" "FG.011" "FG.026" "FG.051" "FG.051" "FG.019" "FG.034" "FG.039"
#&gt; [225] "FG.050"</div><div class='input'>
<span class='co'>## Evaluating differences between retention times within each feature group</span>
<span class='va'>rts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>rowData</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span><span class='op'>$</span><span class='va'>rtmed</span>, <span class='fu'><a href='featureGroups.html'>featureGroups</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>rts</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>&lt;=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $FG.001
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.002
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.003
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.004
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.005
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.006
#&gt; [1] TRUE TRUE TRUE
#&gt; 
#&gt; $FG.007
#&gt; [1] TRUE TRUE TRUE TRUE
#&gt; 
#&gt; $FG.008
#&gt; [1] TRUE TRUE TRUE TRUE TRUE
#&gt; 
#&gt; $FG.009
#&gt; [1] TRUE TRUE TRUE
#&gt; 
#&gt; $FG.010
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.011
#&gt; [1] TRUE TRUE TRUE TRUE
#&gt; 
#&gt; $FG.012
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.013
#&gt; [1] TRUE TRUE TRUE
#&gt; 
#&gt; $FG.014
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.015
#&gt; [1] TRUE TRUE TRUE TRUE
#&gt; 
#&gt; $FG.016
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.017
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.018
#&gt; [1] TRUE TRUE TRUE TRUE
#&gt; 
#&gt; $FG.019
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.020
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.021
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.022
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.023
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.024
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.025
#&gt; [1] TRUE TRUE TRUE TRUE TRUE
#&gt; 
#&gt; $FG.026
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.027
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.028
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.029
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.030
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.031
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.032
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.033
#&gt; [1] TRUE TRUE TRUE
#&gt; 
#&gt; $FG.034
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.035
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.036
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.037
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.038
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.039
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.040
#&gt; [1] TRUE TRUE TRUE
#&gt; 
#&gt; $FG.041
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.042
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.043
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.044
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.045
#&gt; [1] TRUE TRUE TRUE
#&gt; 
#&gt; $FG.046
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.047
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.048
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.049
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.050
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.051
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.052
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.053
#&gt; [1] TRUE TRUE TRUE
#&gt; 
#&gt; $FG.054
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.055
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.056
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.057
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.058
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.059
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.060
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.061
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.062
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.063
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.064
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.065
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.066
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.067
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.068
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.069
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.070
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.071
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.072
#&gt; [1] TRUE TRUE
#&gt; 
#&gt; $FG.073
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.074
#&gt; [1] TRUE
#&gt; 
#&gt; $FG.075
#&gt; logical(0)
#&gt; 
#&gt; $FG.076
#&gt; logical(0)
#&gt; 
#&gt; $FG.077
#&gt; logical(0)
#&gt; 
#&gt; $FG.078
#&gt; logical(0)
#&gt; 
#&gt; $FG.079
#&gt; logical(0)
#&gt; 
#&gt; $FG.080
#&gt; logical(0)
#&gt; 
#&gt; $FG.081
#&gt; logical(0)
#&gt; 
#&gt; $FG.082
#&gt; logical(0)
#&gt; 
#&gt; $FG.083
#&gt; logical(0)
#&gt; 
#&gt; $FG.084
#&gt; logical(0)
#&gt; </div><div class='input'>
<span class='co'>## One feature group ("FG.053") has elements with a difference larger 10:</span>
<span class='va'>rts</span><span class='op'>[[</span><span class='st'>"FG.053"</span><span class='op'>]</span><span class='op'>]</span>
</div><div class='output co'>#&gt; [1] 3473.784 3470.313 3472.164 3474.992</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>rts</span><span class='op'>[[</span><span class='st'>"FG.053"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 3.470799 1.851390 2.828125</div><div class='input'>
<span class='co'>## But the difference between the **sorted** retention times is &lt; 10:</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='va'>rts</span><span class='op'>[[</span><span class='st'>"FG.053"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 1.851390 1.619410 1.208715</div><div class='input'>
<span class='co'>## Feature grouping with pre-defined feature groups: groupFeatures will</span>
<span class='co'>## sub-group the pre-defined feature groups, features with the feature group</span>
<span class='co'>## being `NA` are skipped. Below we perform the feature grouping only on</span>
<span class='co'>## features 40 to 70</span>
<span class='va'>fgs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>rowData</a></span><span class='op'>(</span><span class='va'>se</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>fgs</span><span class='op'>[</span><span class='fl'>40</span><span class='op'>:</span><span class='fl'>70</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"FG"</span>
<span class='fu'><a href='featureGroups.html'>featureGroups</a></span><span class='op'>(</span><span class='va'>se</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>fgs</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='groupFeatures.html'>groupFeatures</a></span><span class='op'>(</span><span class='va'>se</span>, <span class='fu'>SimilarRtimeParam</span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>, rtime <span class='op'>=</span> <span class='st'>"rtmed"</span><span class='op'>)</span>
<span class='fu'><a href='featureGroups.html'>featureGroups</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   [1] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt;   [9] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt;  [17] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt;  [25] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt;  [33] NA       NA       NA       NA       NA       NA       NA       "FG.001"
#&gt;  [41] "FG.009" "FG.010" "FG.007" "FG.001" "FG.011" "FG.012" "FG.006" "FG.004"
#&gt;  [49] "FG.013" "FG.002" "FG.001" "FG.001" "FG.002" "FG.002" "FG.014" "FG.001"
#&gt;  [57] "FG.005" "FG.015" "FG.005" "FG.003" "FG.008" "FG.003" "FG.016" "FG.008"
#&gt;  [65] "FG.003" "FG.004" "FG.004" "FG.006" "FG.017" "FG.007" NA       NA      
#&gt;  [73] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt;  [81] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt;  [89] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt;  [97] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [105] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [113] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [121] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [129] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [137] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [145] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [153] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [161] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [169] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [177] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [185] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [193] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [201] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [209] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [217] NA       NA       NA       NA       NA       NA       NA       NA      
#&gt; [225] NA      </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by RforMassSpectrometry Package Maintainer, Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


