<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Grouping Mass Spectrometry Features • MsFeatures</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Grouping Mass Spectrometry Features">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MsFeatures</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.17.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/MsFeatures.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RforMassSpectrometry/MsFeatures/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Grouping Mass Spectrometry Features</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MsFeatures/blob/main/vignettes/MsFeatures.Rmd" class="external-link"><code>vignettes/MsFeatures.Rmd</code></a></small>
      <div class="d-none name"><code>MsFeatures.Rmd</code></div>
    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><p><strong>Package</strong>: <em><a href="https://bioconductor.org/packages/3.22/MsFeatures" class="external-link">MsFeatures</a></em><br><strong>Authors</strong>: Johannes Rainer [aut, cre] (ORCID: <a href="https://orcid.org/0000-0002-6977-7147" class="external-link uri">https://orcid.org/0000-0002-6977-7147</a>), Johan Lassen
[ctb] (ORCID: <a href="https://orcid.org/0000-0002-0452-566X" class="external-link uri">https://orcid.org/0000-0002-0452-566X</a>)<br><strong>Last modified:</strong> 2025-05-30 09:50:57.097106<br><strong>Compiled</strong>: Fri May 30 09:56:05 2025</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Electrospray ionization (ESI) is commonly used in mass spectrometry
(MS)-based metabolomics to generate ions from the compounds to enable
their detection by the MS instrument. Ionization can generate different
ions (adducts) of the same original compound which are then reported as
separate <em>MS features</em> with different mass-to-charge ratios
(m/z). To reduce data set complexity (and to aid subsequent annotation
steps) it is advisable to group features which supposedly represent
signal from the same original compound into a single entity.</p>
<p>The <code>MsFeatures</code> package provides key concepts and
functions for this feature grouping. Methods are implemented for base R
objects as well as for Bioconductor’s <code>SummarizedExperiment</code>
class. See also the description of the <a href="https://rformassspectrometry.github.io/MsFeatures/reference/groupFeatures.html">general
grouping concept</a> on the package webpage for more information.
Additional grouping methodology is expected to be implemented in other R
packages for data objects with additional LC-MS related information,
such as the <code>XCMSnExp</code> object in the <code>xcms</code>
package. The implementation for the <code>SummarizedExperiment</code>
provided in this package can be used as a reference for these additional
methodology.</p>
<p>After definition of the feature groups, the <em><a href="https://bioconductor.org/packages/3.22/QFeatures" class="external-link">QFeatures</a></em>
package could be used to aggregate their abundances into a single
signal.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package can be installed with the <code>BiocManager</code>
package. To install <code>BiocManager</code> use
<code>install.packages("BiocManager")</code> and, after that,
<code>BiocManager::install("MsFeatures")</code> to install this
package.</p>
</div>
<div class="section level2">
<h2 id="mass-spectrometry-feature-grouping">Mass Spectrometry Feature Grouping<a class="anchor" aria-label="anchor" href="#mass-spectrometry-feature-grouping"></a>
</h2>
<p>Features from the same originating compound inherit its
characteristics including its retention time (for LC or GC-MS
experiments) and abundance/intensity. For the latter it is expected that
features from the same compound have the same pattern of feature
values/abundances across samples.</p>
<p>The <code>MsFeatures</code> package defines the
<code>groupFeatures</code> method to perform MS feature grouping based
on the provided input data and a parameter object which selects and
defines the feature grouping algorithm. This algorithm is supposed to
assign individual features to a (single) feature group. Currently two
feature grouping approaches are implemented:</p>
<ul>
<li>
<code>SimilarRtimeParam</code>: group features based on similar
retention times.</li>
<li>
<code>AbundanceSimilarityParam</code>: group features based on
similar feature values/abundances across samples.</li>
</ul>
<p>Additional algorithms, e.g. by considering also differences in
features’ m/z values matching expected ions/adducts or isotopes, may be
implemented in future in this or other packages.</p>
<p>In this document we demonstrate the feature grouping functionality on
a simple toy data set used also in the <em><a href="https://bioconductor.org/packages/3.22/xcms" class="external-link">xcms</a></em> package
with the raw data being provided in the <code>faahKO</code> data
package. This data set consists of samples from 4 mice with knock-out of
the fatty acid amide hydrolase (FAAH) and 4 wild type mice.
Pre-processing of this data set is described in detail in the
<em>xcms</em> vignette of the <code>xcms</code> package. Below we load
all required packages and the result from this pre-processing which is
provided as a <code>SummarizedExperiment</code> within this package and
can be loaded with <code>data(se)</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsFeatures" class="external-link">MsFeatures</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"se"</span><span class="op">)</span></span></code></pre></div>
<p>Before performing the feature grouping we inspect the result object.
Feature properties and definitions can be accessed with
<code>rowData</code>, the feature abundances with
<code>assay</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 225 rows and 11 columns</span></span>
<span><span class="co">##           mzmed     mzmin     mzmax     rtmed     rtmin     rtmax    npeaks</span></span>
<span><span class="co">##       &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## FT001     200.1     200.1     200.1   2901.63   2880.73   2922.53         2</span></span>
<span><span class="co">## FT002     205.0     205.0     205.0   2789.39   2782.30   2795.36         8</span></span>
<span><span class="co">## FT003     206.0     206.0     206.0   2788.73   2780.73   2792.86         7</span></span>
<span><span class="co">## FT004     207.1     207.1     207.1   2718.12   2713.21   2726.70         7</span></span>
<span><span class="co">## FT005     219.1     219.1     219.1   2518.82   2517.40   2520.81         3</span></span>
<span><span class="co">## ...         ...       ...       ...       ...       ...       ...       ...</span></span>
<span><span class="co">## FT221    591.30     591.3     591.3   3005.03   2992.87   3006.05         5</span></span>
<span><span class="co">## FT222    592.15     592.1     592.3   3022.11   2981.91   3107.59         6</span></span>
<span><span class="co">## FT223    594.20     594.2     594.2   3418.16   3359.10   3427.90         3</span></span>
<span><span class="co">## FT224    595.25     595.2     595.3   3010.15   2992.87   3013.77         6</span></span>
<span><span class="co">## FT225    596.20     596.2     596.2   2997.91   2992.87   3002.95         2</span></span>
<span><span class="co">##              KO        WT            peakidx  ms_level</span></span>
<span><span class="co">##       &lt;numeric&gt; &lt;numeric&gt;             &lt;list&gt; &lt;integer&gt;</span></span>
<span><span class="co">## FT001         2         0  287, 679,1577,...         1</span></span>
<span><span class="co">## FT002         4         4     47,272,542,...         1</span></span>
<span><span class="co">## FT003         3         4     32,259,663,...         1</span></span>
<span><span class="co">## FT004         4         3     19,249,525,...         1</span></span>
<span><span class="co">## FT005         1         2  639, 788,1376,...         1</span></span>
<span><span class="co">## ...         ...       ...                ...       ...</span></span>
<span><span class="co">## FT221         2         3    349,684,880,...         1</span></span>
<span><span class="co">## FT222         1         3     86,861,862,...         1</span></span>
<span><span class="co">## FT223         1         2  604, 985,1543,...         1</span></span>
<span><span class="co">## FT224         2         3     67,353,876,...         1</span></span>
<span><span class="co">## FT225         0         2  866,1447,1643,...         1</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        ko15.CDF   ko16.CDF   ko21.CDF  ko22.CDF  wt15.CDF  wt16.CDF  wt21.CDF</span></span>
<span><span class="co">## FT001  159738.1  506848.88  113441.08  169955.6  216096.6  145509.7  230477.9</span></span>
<span><span class="co">## FT002 1924712.0 1757150.96 1383416.72 1180288.2 2129885.1 1634342.0 1623589.2</span></span>
<span><span class="co">## FT003  213659.3  289500.67  162897.19  178285.7  253825.6  241844.4  240606.0</span></span>
<span><span class="co">## FT004  349011.5  451863.66  343897.76  208002.8  364609.8  360908.9  223322.5</span></span>
<span><span class="co">## FT005  135978.5   25524.79   71530.84  107348.5  223951.8  134398.9  190203.8</span></span>
<span><span class="co">## FT006  286221.4  289908.23  164008.97  149097.6  255697.7  311296.8  366441.5</span></span>
<span><span class="co">##         wt22.CDF</span></span>
<span><span class="co">## FT001  140551.30</span></span>
<span><span class="co">## FT002 1354004.93</span></span>
<span><span class="co">## FT003  185399.47</span></span>
<span><span class="co">## FT004  221937.53</span></span>
<span><span class="co">## FT005   84772.92</span></span>
<span><span class="co">## FT006  271128.02</span></span></code></pre>
<p>Columns <code>"mzmed"</code> and <code>"rtmed"</code> in the object’s
<code>rowData</code> provide the m/z and retention time which
characterizes each feature. In total 225 features are available in the
present data set, with many of them most likely representing signal from
different ions of the same compound. We aim to identify these based on
the following assumptions of the LC-MS data:</p>
<ul>
<li>Features (ions) of the same compound should have similar retention
time.</li>
<li>The abundance of features (ions) of the same compound should have a
similar pattern across samples, i.e. if a compound is highly
concentrated in one sample and low in another, all ions from it also
should follow the same pattern.</li>
</ul>
<p>As detailed in the <a href="https://rformassspectrometry.github.io/MsFeatures/reference/groupFeatures.html">general
grouping concept</a>, the feature grouping implemented in
<code>MsFeatures</code> is by default intended to be used as a stepwise
approach in which each <code>groupFeatures</code> call further
sub-groups (and thus refines) previously defined feature groups. This
enables to either use a single algorithm for the feature grouping or to
build a feature grouping <em>pipeline</em> by combining different
algorithms. In our example we perform first a initial grouping of
features based on similar retention time and subsequently further refine
these feature groups by requiring also similarity of feature values
across samples.</p>
<p>Note that it would also be possible to perform the grouping only on a
subset of features instead of the full data set. An example is provided
in the last section of this vignette.</p>
<div class="section level3">
<h3 id="grouping-of-features-by-similar-retention-time">Grouping of features by similar retention time<a class="anchor" aria-label="anchor" href="#grouping-of-features-by-similar-retention-time"></a>
</h3>
<p>The most intuitive and simple way to group LC-MS features is based on
their retention times: ionization of the compounds happens after the LC
and thus all ions from the same compound should have the same retention
time. The plot below shows the retention times (and m/z) of all features
from the present data set.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">rtmed</span>, <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">mzmed</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"retention time"</span>, ylab <span class="op">=</span> <span class="st">"m/z"</span>, main <span class="op">=</span> <span class="st">"features"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"#00000060"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="MsFeatures_files/figure-html/feature-rt-mz-plot-1.png" alt="Plot of retention times and m/z for all features in the data set." width="768"><p class="caption">
Plot of retention times and m/z for all features in the data set.
</p>
</div>
<p>As we can see there are several features with a similar retention
time, especially for lower retention times. By using
<code>groupFeatures</code> with the <code>SimilarRtimeParam</code> we
can next group features if their difference in retention time is below a
certain threshold. This approach will however not only group features
representing ions from the same compound together, but also features
from different, but co-eluting compounds (i.e. different compounds with
the same retention time). Thus feature groups defined by this algorithm
should be further <em>refined</em> based on another feature property to
reduce false positives.</p>
<p>For the present example, we group features with a maximal difference
in retention time of 10 seconds into a feature group. We also have to
specify the column in the object’s <code>rowData</code> which contains
the retention times for the features.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/groupFeatures.html">groupFeatures</a></span><span class="op">(</span><span class="va">se</span>, param <span class="op">=</span> <span class="fu"><a href="../reference/groupFeatures-similar-rtime.html">SimilarRtimeParam</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, rtime <span class="op">=</span> <span class="st">"rtmed"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>groupFeatures</code> call on the
<code>SummarizedExperiment</code> added the results of the grouping into
a new column called <code>"feature_group"</code> in the object’s
<code>rowData</code>. This column can also be directly accessed with the
<code>featureGroups</code> function. Below we print the number of
features for each feature grouped defined by the
<code>SimilarRtimeParam</code> approach.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/featureGroups.html">featureGroups</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## FG.001 FG.002 FG.003 FG.004 FG.005 FG.006 FG.007 FG.008 FG.009 FG.010 FG.011 </span></span>
<span><span class="co">##      3     20      2      3      7      1      3      2     10      3      8 </span></span>
<span><span class="co">## FG.012 FG.013 FG.014 FG.015 FG.016 FG.017 FG.018 FG.019 FG.020 FG.021 FG.022 </span></span>
<span><span class="co">##      2      4      6      2      6      2      5      4      4      3      6 </span></span>
<span><span class="co">## FG.023 FG.024 FG.025 FG.026 FG.027 FG.028 FG.029 FG.030 FG.031 FG.032 FG.033 </span></span>
<span><span class="co">##      6      5      5     13      2      1      3      6      2      2      1 </span></span>
<span><span class="co">## FG.034 FG.035 FG.036 FG.037 FG.038 FG.039 FG.040 FG.041 FG.042 FG.043 FG.044 </span></span>
<span><span class="co">##      1      3      2      4      5      1      4      1      1      3      4 </span></span>
<span><span class="co">## FG.045 FG.046 FG.047 FG.048 FG.049 FG.050 FG.051 FG.052 FG.053 FG.054 FG.055 </span></span>
<span><span class="co">##      4      3      4      2      2      4      3      3      3      1      1 </span></span>
<span><span class="co">## FG.056 FG.057 FG.058 FG.059 FG.060 FG.061 </span></span>
<span><span class="co">##      1      6      2      1      3      1</span></span></code></pre>
<p>We also calculate the mean retention time for all the feature groups
and order them increasingly.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">rtmed</span>, <span class="fu"><a href="../reference/featureGroups.html">featureGroups</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="va">mean</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   FG.020   FG.004   FG.033   FG.012   FG.026   FG.031   FG.003   FG.008 </span></span>
<span><span class="co">## 2508.281 2518.143 2595.503 2623.786 2686.386 2694.089 2718.799 2731.648 </span></span>
<span><span class="co">##   FG.027   FG.002   FG.010   FG.006   FG.061   FG.054   FG.032   FG.001 </span></span>
<span><span class="co">## 2751.041 2789.451 2799.149 2832.560 2860.496 2871.735 2881.899 2899.457 </span></span>
<span><span class="co">##   FG.058   FG.013   FG.015   FG.042   FG.017   FG.057   FG.044   FG.005 </span></span>
<span><span class="co">## 2915.107 2924.922 2936.602 2953.627 2998.303 3008.855 3015.635 3025.246 </span></span>
<span><span class="co">##   FG.047   FG.041   FG.034   FG.016   FG.060   FG.059   FG.007   FG.048 </span></span>
<span><span class="co">## 3041.468 3057.242 3070.855 3079.146 3088.353 3114.721 3128.047 3142.710 </span></span>
<span><span class="co">##   FG.036   FG.030   FG.053   FG.056   FG.052   FG.045   FG.051   FG.009 </span></span>
<span><span class="co">## 3161.133 3170.219 3184.355 3203.298 3217.009 3226.662 3242.698 3261.855 </span></span>
<span><span class="co">##   FG.019   FG.018   FG.039   FG.025   FG.035   FG.028   FG.038   FG.055 </span></span>
<span><span class="co">## 3286.543 3298.726 3311.799 3323.372 3335.200 3347.739 3357.974 3372.908 </span></span>
<span><span class="co">##   FG.049   FG.050   FG.011   FG.040   FG.022   FG.043   FG.023   FG.037 </span></span>
<span><span class="co">## 3383.014 3397.578 3407.032 3416.295 3425.499 3435.389 3445.748 3460.945 </span></span>
<span><span class="co">##   FG.046   FG.024   FG.029   FG.014   FG.021 </span></span>
<span><span class="co">## 3470.201 3476.921 3483.910 3497.730 3510.664</span></span></code></pre>
<p>Note that the differences in retention times between the feature
groups can be smaller than the used cut-off (10 seconds in our case). If
we were not happy with this feature grouping and would like to repeat it
we would need to drop the <code>"feature_group"</code> column in the
object’s <code>rowData</code> with
<code>rowData(se)$feature_group &lt;- NULL</code> and repeat the feature
grouping with different settings. This is required, because by default
<code>groupFeatures</code> will <em>refine</em> previous feature
grouping results but not overwrite them.</p>
<p>As stated above, this initial grouping on retention times put
features from the same, but also from different co-eluting compounds
into the same feature group. We thus next refine the feature groups
requiring also feature abundances across samples to be correlated.</p>
</div>
<div class="section level3">
<h3 id="grouping-of-features-by-abundance-correlation-across-samples">Grouping of features by abundance correlation across samples<a class="anchor" aria-label="anchor" href="#grouping-of-features-by-abundance-correlation-across-samples"></a>
</h3>
<p>Features representing ions of the same compound are expected to have
correlated feature values (intensities, abundances) across samples.
<code>groupFeatures</code> with <code>AbundanceSimilarityParam</code>
allows to group features with similar abundance patterns. This approach
performs a pairwise similarity calculation and puts features with a
similarity <code>&gt;= threshold</code> into the same feature group. By
calling this function on the previous result object the initial feature
groups will be refined, by eventually splitting them based on the
(missing) correlation of feature abundances.</p>
<p>We below evaluate the correlation between individual features
indicating also the previously defined feature groups.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pheatmap</span><span class="op">)</span></span>
<span><span class="va">fvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cormat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">fvals</span><span class="op">)</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span><span class="va">ann</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>fgroup <span class="op">=</span> <span class="fu"><a href="../reference/featureGroups.html">featureGroups</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ann</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cormat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span><span class="va">cormat</span>, annotation_row <span class="op">=</span> <span class="va">ann</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                cluster_cols <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="MsFeatures_files/figure-html/abundance-correlation-heatmap-1.png" alt="Correlation of features based on their abundances." width="1152"><p class="caption">
Correlation of features based on their abundances.
</p>
</div>
<p>As expected, the clustering based on the feature abundances does not
perfectly match the retention time-based feature grouping. Many features
grouped based on retention time have a low, or even negative correlation
of feature abundances across samples hence most likely representing
features from different, but co-eluting compounds. On the other hand,
many features are highly correlated, but have a different retention time
and can thus also not represent signal from ions of the same compound.
Thus, each single approach has its drawbacks, but combination them can
reduce the number of wrongly grouped features.</p>
<p>We thus next perform the feature grouping with
<code>AbundanceSimilarityParam</code> on the result object to refine the
retention time-based feature groups. The approach can be further
customized by providing a function to calculate feature similarities
with parameter <code>simFun</code> (by default <code>cor</code> will be
used to calculate similarities using Pearson’s correlation). Parameter
<code>transform</code> allows to specify a function to transform feature
abundances prior similarity calculation. By default the feature values
are taken <em>as-is</em>, but below we use <code>transform = log2</code>
to perform the calculations in log2 scale. With
<code>threshold = 0.7</code> we ensure that only features with a
correlation coefficient <code>&gt;= 0.7</code> are assigned to the same
feature group. Finally, parameter <code>i</code> would allow to specify
the assay in the <code>SummarizedExperiment</code> that contains the
feature abundances on which similarities should be calculated. See the
<code>AbundanceSimilarityParam</code> help page for a full listing of
the parameters and more details.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/groupFeatures.html">groupFeatures</a></span><span class="op">(</span><span class="va">se</span>, <span class="fu"><a href="../reference/groupFeatures-similar-abundance.html">AbundanceSimilarityParam</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                                                 transform <span class="op">=</span> <span class="va">log2</span><span class="op">)</span>, i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/featureGroups.html">featureGroups</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## FG.001.001 FG.001.002 FG.001.003 FG.002.001 FG.002.002 FG.002.003 FG.002.004 </span></span>
<span><span class="co">##          1          1          1          6          6          2          1 </span></span>
<span><span class="co">## FG.002.005 FG.002.006 FG.002.007 FG.002.008 FG.002.009 FG.003.001 FG.004.001 </span></span>
<span><span class="co">##          1          1          1          1          1          2          1 </span></span>
<span><span class="co">## FG.004.002 FG.004.003 FG.005.001 FG.005.002 FG.005.003 FG.005.004 FG.006.001 </span></span>
<span><span class="co">##          1          1          4          1          1          1          1 </span></span>
<span><span class="co">## FG.007.001 FG.007.002 FG.008.001 FG.008.002 FG.009.001 FG.009.002 FG.009.003 </span></span>
<span><span class="co">##          2          1          1          1          2          2          1 </span></span>
<span><span class="co">## FG.009.004 FG.009.005 FG.009.006 FG.009.007 FG.009.008 FG.010.001 FG.010.002 </span></span>
<span><span class="co">##          1          1          1          1          1          2          1 </span></span>
<span><span class="co">## FG.011.001 FG.011.002 FG.011.003 FG.011.004 FG.011.005 FG.012.001 FG.013.001 </span></span>
<span><span class="co">##          2          3          1          1          1          2          1 </span></span>
<span><span class="co">## FG.013.002 FG.013.003 FG.013.004 FG.014.001 FG.014.002 FG.014.003 FG.014.004 </span></span>
<span><span class="co">##          1          1          1          2          1          1          1 </span></span>
<span><span class="co">## FG.014.005 FG.015.001 FG.015.002 FG.016.001 FG.016.002 FG.016.003 FG.017.001 </span></span>
<span><span class="co">##          1          1          1          3          2          1          1 </span></span>
<span><span class="co">## FG.017.002 FG.018.001 FG.018.002 FG.019.001 FG.019.002 FG.019.003 FG.020.001 </span></span>
<span><span class="co">##          1          3          2          2          1          1          4 </span></span>
<span><span class="co">## FG.021.001 FG.021.002 FG.022.001 FG.022.002 FG.022.003 FG.022.004 FG.022.005 </span></span>
<span><span class="co">##          2          1          2          1          1          1          1 </span></span>
<span><span class="co">## FG.023.001 FG.023.002 FG.023.003 FG.023.004 FG.023.005 FG.024.001 FG.024.002 </span></span>
<span><span class="co">##          2          1          1          1          1          2          1 </span></span>
<span><span class="co">## FG.024.003 FG.024.004 FG.025.001 FG.025.002 FG.025.003 FG.025.004 FG.026.001 </span></span>
<span><span class="co">##          1          1          2          1          1          1          2 </span></span>
<span><span class="co">## FG.026.002 FG.026.003 FG.026.004 FG.026.005 FG.026.006 FG.026.007 FG.026.008 </span></span>
<span><span class="co">##          3          2          1          1          1          1          1 </span></span>
<span><span class="co">## FG.026.009 FG.027.001 FG.028.001 FG.029.001 FG.029.002 FG.030.001 FG.030.002 </span></span>
<span><span class="co">##          1          2          1          2          1          3          1 </span></span>
<span><span class="co">## FG.030.003 FG.030.004 FG.031.001 FG.031.002 FG.032.001 FG.032.002 FG.033.001 </span></span>
<span><span class="co">##          1          1          1          1          1          1          1 </span></span>
<span><span class="co">## FG.034.001 FG.035.001 FG.035.002 FG.036.001 FG.036.002 FG.037.001 FG.037.002 </span></span>
<span><span class="co">##          1          2          1          1          1          3          1 </span></span>
<span><span class="co">## FG.038.001 FG.038.002 FG.039.001 FG.040.001 FG.040.002 FG.040.003 FG.040.004 </span></span>
<span><span class="co">##          4          1          1          1          1          1          1 </span></span>
<span><span class="co">## FG.041.001 FG.042.001 FG.043.001 FG.043.002 FG.043.003 FG.044.001 FG.044.002 </span></span>
<span><span class="co">##          1          1          1          1          1          2          2 </span></span>
<span><span class="co">## FG.045.001 FG.045.002 FG.046.001 FG.046.002 FG.047.001 FG.047.002 FG.047.003 </span></span>
<span><span class="co">##          3          1          2          1          2          1          1 </span></span>
<span><span class="co">## FG.048.001 FG.048.002 FG.049.001 FG.049.002 FG.050.001 FG.050.002 FG.050.003 </span></span>
<span><span class="co">##          1          1          1          1          2          1          1 </span></span>
<span><span class="co">## FG.051.001 FG.051.002 FG.051.003 FG.052.001 FG.052.002 FG.053.001 FG.054.001 </span></span>
<span><span class="co">##          1          1          1          2          1          3          1 </span></span>
<span><span class="co">## FG.055.001 FG.056.001 FG.057.001 FG.057.002 FG.058.001 FG.059.001 FG.060.001 </span></span>
<span><span class="co">##          1          1          5          1          2          1          2 </span></span>
<span><span class="co">## FG.060.002 FG.061.001 </span></span>
<span><span class="co">##          1          1</span></span></code></pre>
<p>Many of the larger retention time-based feature groups have been
splitted into two or more sub-groups based on the correlation of their
feature abundances. We evaluate this for one specific feature group
<code>"FG.003"</code> by plotting their pairwise correlation.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"FG.003"</span>, <span class="fu"><a href="../reference/featureGroups.html">featureGroups</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">fvals</span><span class="op">[</span><span class="va">fts</span>, <span class="op">]</span><span class="op">)</span>, gap <span class="op">=</span> <span class="fl">0.1</span>, main <span class="op">=</span> <span class="st">"FG.003"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="MsFeatures_files/figure-html/abundance-correlation-fg003-1.png" alt="Pairwise correlation plot for  features initially grouped into the feature group FG.003." width="768"><p class="caption">
Pairwise correlation plot for features initially grouped into the
feature group FG.003.
</p>
</div>
<p>A high correlation can be observed between <em>FT035</em> and
<em>FT051</em> while they are not correlated with feature
<em>FT013</em>. We next evaluate the feature grouping for another
example.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"FG.008"</span>, <span class="fu"><a href="../reference/featureGroups.html">featureGroups</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">fvals</span><span class="op">[</span><span class="va">fts</span>, <span class="op">]</span><span class="op">)</span>, gap <span class="op">=</span> <span class="fl">0.1</span>, main <span class="op">=</span> <span class="st">"FG.008"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="MsFeatures_files/figure-html/abundance-correlation-fg008-1.png" alt="Pairwise correlation plot for  features initially grouped into the feature group FG.008." width="768"><p class="caption">
Pairwise correlation plot for features initially grouped into the
feature group FG.008.
</p>
</div>
<p>The results are less clear than for the previous example, still, some
features seem to be correlated with each other while others are not.
Generally, the abundance correlation approach in this data set suffers
from the low number of sample (8 in total). Also, the approach works
better for features with a high variance (biologically or technically)
across samples.</p>
<p>The table below lists the retention time, m/z and group assignment
for these features.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[</span><span class="va">fts</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rtmed"</span>, <span class="st">"mzmed"</span>, <span class="st">"feature_group"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">feature_group</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">rtmed</th>
<th align="right">mzmed</th>
<th align="left">feature_group</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">FT010</td>
<td align="right">2732.939</td>
<td align="right">272.1</td>
<td align="left">FG.008.001</td>
</tr>
<tr class="even">
<td align="left">FT018</td>
<td align="right">2730.358</td>
<td align="right">296.1</td>
<td align="left">FG.008.002</td>
</tr>
</tbody>
</table>
<p>The difference in m/z between features <em>FT163</em> and
<em>FT165</em>, both being assigned to the same feature group, is ~ 1
suggesting that one of the two is in fact a (C13) isotope of the other
feature.</p>
</div>
<div class="section level3">
<h3 id="performing-feature-grouping-on-a-subset-of-features">Performing feature grouping on a subset of features<a class="anchor" aria-label="anchor" href="#performing-feature-grouping-on-a-subset-of-features"></a>
</h3>
<p>Sometimes it might not be needed or required to perform the feature
grouping on the full data set but only on a subset of
<em>interesting</em> features (i.e. those with significant differences
in feature abundances between sample groups). This has also the
advantage of a larger range of feature values across samples which
supports the abundance similarity-based feature grouping.</p>
<p>Feature grouping on a subset of features can be performed by manually
assigning all features of interest to an initial feature group and
setting the feature group for all other features to <code>NA</code>. As
an example we perform below the feature grouping only features
30-60.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/featureGroups.html">featureGroups</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA_character_</span></span>
<span><span class="fu"><a href="../reference/featureGroups.html">featureGroups</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[</span><span class="fl">30</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"FG"</span></span>
<span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/groupFeatures.html">groupFeatures</a></span><span class="op">(</span><span class="va">se</span>, <span class="fu"><a href="../reference/groupFeatures-similar-rtime.html">SimilarRtimeParam</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, rtime <span class="op">=</span> <span class="st">"rtmed"</span><span class="op">)</span></span></code></pre></div>
<p>This did not <em>refine</em> this initial, manually specified feature
group by the retention time-based grouping. Features with
<code>NA</code> value in their feature group column are skipped. As a
result we get the following grouping:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/featureGroups.html">featureGroups</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   [1] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">##   [9] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">##  [17] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">##  [25] NA       NA       NA       NA       NA       "FG.001" "FG.002" "FG.003"</span></span>
<span><span class="co">##  [33] "FG.004" "FG.005" "FG.004" "FG.006" "FG.007" "FG.007" "FG.002" "FG.004"</span></span>
<span><span class="co">##  [41] "FG.002" "FG.008" "FG.009" "FG.004" "FG.006" "FG.010" "FG.011" "FG.009"</span></span>
<span><span class="co">##  [49] "FG.012" "FG.007" "FG.004" "FG.004" "FG.007" "FG.007" "FG.013" "FG.004"</span></span>
<span><span class="co">##  [57] "FG.014" "FG.015" "FG.014" "FG.016" NA       NA       NA       NA      </span></span>
<span><span class="co">##  [65] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">##  [73] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">##  [81] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">##  [89] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">##  [97] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [105] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [113] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [121] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [129] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [137] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [145] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [153] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [161] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [169] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [177] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [185] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [193] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [201] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [209] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [217] NA       NA       NA       NA       NA       NA       NA       NA      </span></span>
<span><span class="co">## [225] NA</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<pre><code><span><span class="co">## R version 4.5.0 (2025-04-11)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] pheatmap_1.0.12             SummarizedExperiment_1.39.0</span></span>
<span><span class="co">##  [3] Biobase_2.69.0              GenomicRanges_1.61.0       </span></span>
<span><span class="co">##  [5] GenomeInfoDb_1.45.3         IRanges_2.43.0             </span></span>
<span><span class="co">##  [7] S4Vectors_0.47.0            BiocGenerics_0.55.0        </span></span>
<span><span class="co">##  [9] generics_0.1.4              MatrixGenerics_1.21.0      </span></span>
<span><span class="co">## [11] matrixStats_1.5.0           MsFeatures_1.17.0          </span></span>
<span><span class="co">## [13] BiocStyle_2.37.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] sass_0.4.10         MsCoreUtils_1.21.0  SparseArray_1.9.0  </span></span>
<span><span class="co">##  [4] lattice_0.22-7      digest_0.6.37       evaluate_1.0.3     </span></span>
<span><span class="co">##  [7] grid_4.5.0          RColorBrewer_1.1-3  bookdown_0.43      </span></span>
<span><span class="co">## [10] fastmap_1.2.0       jsonlite_2.0.0      Matrix_1.7-3       </span></span>
<span><span class="co">## [13] ProtGenerics_1.41.0 BiocManager_1.30.25 httr_1.4.7         </span></span>
<span><span class="co">## [16] scales_1.4.0        UCSC.utils_1.5.0    textshaping_1.0.1  </span></span>
<span><span class="co">## [19] jquerylib_0.1.4     abind_1.4-8         cli_3.6.5          </span></span>
<span><span class="co">## [22] rlang_1.1.6         crayon_1.5.3        XVector_0.49.0     </span></span>
<span><span class="co">## [25] cachem_1.1.0        DelayedArray_0.35.1 yaml_2.3.10        </span></span>
<span><span class="co">## [28] S4Arrays_1.9.0      tools_4.5.0         R6_2.6.1           </span></span>
<span><span class="co">## [31] lifecycle_1.0.4     fs_1.6.6            htmlwidgets_1.6.4  </span></span>
<span><span class="co">## [34] clue_0.3-66         MASS_7.3-65         ragg_1.4.0         </span></span>
<span><span class="co">## [37] cluster_2.1.8.1     desc_1.4.3          pkgdown_2.1.3.9000 </span></span>
<span><span class="co">## [40] bslib_0.9.0         gtable_0.3.6        glue_1.8.0         </span></span>
<span><span class="co">## [43] systemfonts_1.2.3   xfun_0.52           knitr_1.50         </span></span>
<span><span class="co">## [46] farver_2.1.2        htmltools_0.5.8.1   rmarkdown_2.29     </span></span>
<span><span class="co">## [49] compiler_4.5.0</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Rainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
